{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '45237903-940e6dd06b8edc671dac0e6f2';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst perPage = 15;\n\nexport const fetchImages = async (query, page = 1, per_page = perPage) => {\n  try {\n    const params = {\n      key: API_KEY,\n      q: query,\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page,\n    };\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n};\n","export function createGalleryMarkup(images) {\n  return images\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `<li class=\"gallery-list\">\n        <a class=\"gallery-link\" href=\"${largeImageURL}\" >\n          <img\n            class=\"gallery-image\"\n            src=\"${webformatURL}\"\n            alt=\"${tags}\"\n          />\n          <ul class=\"gallery-block\">\n            <li>\n              <p class=\"gallery-text\">Likes</p>\n              <p class=\"gallery-info\">${likes}</p>\n            </li>\n            <li>\n              <p class=\"gallery-text\">Views</p>\n              <p class=\"gallery-info\">${views}</p>\n            </li>\n            <li>\n              <p class=\"gallery-text\">Comments</p>\n              <p class=\"gallery-info\">${comments}</p>\n            </li>\n            <li>\n              <p class=\"gallery-text\">Downloads</p>\n              <p class=\"gallery-info\">${downloads}</p>\n            </li>\n          </ul>\n        </a>\n      </li>`;\n      }\n    )\n    .join('');\n}\n\nexport function clearGallery() {\n  document.querySelector('.gallery').innerHTML = '';\n}\n\nexport function renderGallery(markup) {\n  document.querySelector('.gallery').insertAdjacentHTML('beforeend', markup);\n}\n","import { fetchImages } from './js/pixabay-api.js';\nimport {\n  createGalleryMarkup,\n  clearGallery,\n  renderGallery,\n} from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.getElementById('search-form');\nconst input = document.getElementById('search-input');\nconst loadMoreBtn = document.querySelector('.load-more');\nconst loader = document.getElementById('loader');\nconst formData = { text: '' };\nconst STORAGE_KEY = 'search-form-state';\nconst perPage = 15;\n\npopulateForm();\n\nlet query = '';\nlet page = 1;\nlet simpleLightbox;\n\nform.addEventListener('input', handleFormInput);\nform.addEventListener('submit', handleFormSubmit);\nloadMoreBtn.addEventListener('click', handleLoadMore);\n\nfunction handleFormInput(event) {\n  const { name, value } = event.target;\n  formData[name] = value.trim();\n\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(formData));\n}\n\nfunction populateForm() {\n  try {\n    const savedData = localStorage.getItem(STORAGE_KEY);\n    if (!savedData) return;\n    const parsedData = JSON.parse(savedData);\n\n    for (const [key, value] of Object.entries(parsedData)) {\n      if (form.elements[key]) {\n        form.elements[key].value = value;\n        formData[key] = value;\n      }\n    }\n  } catch (err) {\n    console.error('Error parsing localStorage data:', err);\n  }\n}\n\nasync function handleFormSubmit(event) {\n  event.preventDefault();\n  query = input.value.trim();\n  if (!query) {\n    showError('Please enter a search query');\n    return;\n  }\n\n  clearGallery();\n  page = 1;\n  loadMoreBtn.classList.add('is-hidden');\n  showLoader();\n  try {\n    const data = await fetchImages(query, page);\n    hideLoader();\n\n    if (data.hits.length === 0) {\n      showInfo('No images found for your query');\n      return;\n    }\n\n    const markup = createGalleryMarkup(data.hits);\n    renderGallery(markup);\n\n    simpleLightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n      captionPosition: 'bottom',\n      className: 'simple-lightbox',\n    });\n\n    if (data.hits.length < perPage) {\n      loadMoreBtn.classList.add('is-hidden');\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n    input.value = '';\n  } catch (error) {\n    hideLoader();\n    showError('Failed to fetch images');\n  }\n}\n\nasync function handleLoadMore() {\n  page += 1;\n  showLoader();\n\n  try {\n    const data = await fetchImages(query, page);\n    hideLoader();\n\n    const markup = createGalleryMarkup(data.hits);\n    renderGallery(markup);\n    simpleLightbox.refresh();\n    scrollPage();\n\n    if (data.hits.length < perPage || data.hits.length === 0) {\n      loadMoreBtn.classList.add('is-hidden');\n      showInfo(\"We're sorry, but you've reached the end of search results.\");\n    }\n  } catch (error) {\n    hideLoader();\n    showError('Failed to fetch more images');\n  }\n}\nfunction scrollPage() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nfunction showError(message) {\n  iziToast.error({\n    title: 'Error',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n  });\n}\n\nfunction showInfo(message) {\n  iziToast.info({\n    title: '',\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n  });\n}\n\nfunction showLoader() {\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  loader.style.display = 'none';\n}\n"],"names":["API_KEY","BASE_URL","perPage","fetchImages","query","page","per_page","params","axios","error","createGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","clearGallery","renderGallery","markup","form","input","loadMoreBtn","loader","formData","STORAGE_KEY","populateForm","simpleLightbox","handleFormInput","handleFormSubmit","handleLoadMore","event","name","value","savedData","parsedData","key","err","showError","showLoader","data","hideLoader","showInfo","SimpleLightbox","scrollPage","cardHeight","message","iziToast"],"mappings":"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"}